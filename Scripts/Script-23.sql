select * from  cmo_griveance_test2()

SELECT MAX(CASE WHEN gm.applicant_reigion = 04 THEN gm.religionwise_count END) AS grievances_received_buddhist, MAX(CASE WHEN gm.applicant_reigion = 05 THEN gm.religionwise_count END) AS grievances_received_sikh, MAX(CASE WHEN gm.applicant_reigion = 06 THEN gm.religionwise_count END) AS grievances_received_jain, MAX(CASE WHEN gm.applicant_reigion = 07 THEN gm.religionwise_count END) AS grievances_received_other, MAX(CASE WHEN gm.applicant_reigion = 01 THEN gm.religionwise_count END) AS grievances_received_hindu, MAX(CASE WHEN gm.applicant_reigion = 02 THEN gm.religionwise_count END) AS grievances_received_muslim, MAX(CASE WHEN gm.applicant_reigion = 03 THEN gm.religionwise_count END) AS grievances_received_christian, MAX(CASE WHEN gm.applicant_reigion = 08 THEN gm.religionwise_count END) AS grievances_received_not known, MAX(CASE WHEN gm.applicant_reigion = TR01 THEN gm.religionwise_count END) AS grievances_received_test religion, MAX(CASE WHEN gm.applicant_reigion IS NULL THEN 1 END) AS grievances_received_no_religion FROM (SELECT count(1) AS religionwise_count, gm.applicant_reigion, crm.religion_name FROM grievance_master gm LEFT JOIN cmo_religion_master crm ON crm.religion_id = gm.applicant_reigion WHERE gm.created_on >= '2023-06-08' GROUP BY gm.applicant_reigion, crm.religion_name) AS gm;